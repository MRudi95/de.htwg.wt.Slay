@(ctrl: SlayController, message: String)

@import de.htwg.se.slay.model.gamepieceComponent.NoPiece
@import de.htwg.se.slay.model.gamepieceComponent.Tree
@import de.htwg.se.slay.model.gamepieceComponent.Grave
@import de.htwg.se.slay.model.gamepieceComponent.Castle
@import de.htwg.se.slay.model.gamepieceComponent.Knight
@import de.htwg.se.slay.model.gamepieceComponent.Capital
@import de.htwg.se.slay.model.gamepieceComponent.Peasant
@import de.htwg.se.slay.model.gamepieceComponent.Baron
@import de.htwg.se.slay.model.gamepieceComponent.Spearman

@item(idx: Int) = {
    @ctrl.gameController.grid(idx).owner match {
        case x if ctrl.gameController.players(0) == x => {
            <div id="@idx" xml:id="" class="clickable grid-item c0"> @gamePiece(idx) </div>
        }
        case x if ctrl.gameController.players(1) == x => {
            <div id="@idx" class="clickable grid-item c1"> @gamePiece(idx) </div>
        }
        case x if ctrl.gameController.players(2) == x => {
            <div id="@idx" class="clickable grid-item c2"> @gamePiece(idx) </div>
        }
        case _ => {
        }
    }
}

@cell(idx: Int) = {
@ctrl.gameController.grid(idx).owner match {
    case x if ctrl.gameController.players(0) == x => {
        <td class="cellP0 border border-light"/>
    }
    case x if ctrl.gameController.players(1) == x => {
        <td class="cellP1 border border-light"/>
    }
    case x if ctrl.gameController.players(2) == x => {
        <td class="cellP2 border border-light"/>
    }
    case _ => {
    }
}
}

@gamePiece(idx: Int) = {
@ctrl.gameController.grid(idx).gamepiece match {
    case _:NoPiece  => {}
    case _:Tree     => { <i class="fas fa-tree"></i> }
    case _:Grave    => { <img src=@routes.Assets.versioned("images/grave.png")> }
    case _:Capital  => { <i class="fas fa-home"></i> }
    case _:Castle   => { <img src=@routes.Assets.versioned("images/castle.png")> }
    case _:Peasant  => { <img src=@routes.Assets.versioned("images/peasant.gif")> }
    case _:Spearman => { <img src=@routes.Assets.versioned("images/spearman.gif")> }
    case _:Knight   => { <img src=@routes.Assets.versioned("images/knight.gif")> }
    case _:Baron    => { <img src=@routes.Assets.versioned("images/baron.gif")> }
    case _ => {}
}
}

@cellIndex(rows: Int, cols: Int) = @{
    rows * (ctrl.gameController.grid.colIdx+1) + cols
}


@main(title="Slay Game", style="main"){
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <a class="navbar-brand" href="#">Slay</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item active">
                    <a class="nav-link" href="/about">About</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/undo">Undo</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/redo">Redo</a>
                </li>
                <li>
                    <a class="nav-link" href="http://www.windowsgames.co.uk/slay.html">Original</a>
                </li>
                <li>
                    <a class="nav-link" href="https://github.com/MRudi95/de.htwg.wt.Slay">GitHub</a>
                </li>
            </ul>
        </div>
    </nav>

    <div class="pagecontainer">
        <div id="col" style="display: none">@ctrl.gameController.grid.colIdx</div>
        <div id="row" style="display: none">@ctrl.gameController.grid.rowIdx</div>
        <div class="grid-container">
            @for(i <- 0 to ctrl.gameController.grid.colIdx){
                <div class="grid-item c0" style="background: #343a40; color: #fff;">@{var char = 65; char+= i; char.toChar}</div>
            }
        @for(rows <- 0 to ctrl.gameController.grid.rowIdx){
            @for(cols <- 0 to ctrl.gameController.grid.colIdx){
                @item(cellIndex(rows, cols))
            }
        }
        </div>

        <div class="d-flex justify-content-between p-3">
            <div class="col-1">
                <button id="coord0" class="coordButton col-16"></button>
            </div>
            <div class="col-1">
                <button id="coord1" class="coordButton col-16"></button>
            </div>
            <div class="col-7"></div>
            @if(ctrl.gameController.state == 1){
                <div class="alert alert-warning col-md-auto" role="alert">
                    It is your turn @ctrl.getPlayerturn() !
                </div>
            }else{
                <div class="alert alert-success col-md-auto" role="alert">
                    It is your turn @ctrl.getPlayerturn() !
                </div>
            }
        </div>

        <div id="gameBtnPanel">
            <div class="col-4"></div>
            <button id="buyBtn" class="gameButton">Buy</button>
            <button id="combineBtn" class="gameButton">Combine</button>
            <button id="moveBtn" class="gameButton">Move</button>
            <button id="castleBtn" class="gameButton">Castle</button>
            <button id="balanceBtn" class="gameButton">Balance</button>
            <button id="endTurnBtn" class="gameButton">End Turn</button>
            <button id="surrenderBtn" class="gameButton">Surrender</button>
        </div>

        <div id="gameMsg" class="alert alert-info mr-3 ml-3" role="alert">yeet</div>

        @*dirty*@
        <script src="@routes.Assets.versioned("javascripts/slay.js")" ></script>
    </div>
}


